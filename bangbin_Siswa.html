<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kelola Data Siswa</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="https://lh3.googleusercontent.com/d/1_4llqCMNoBDmwDHsI7RYsCM6rSK5wEjw">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* Style untuk judul dan ikon home */
        .title-wrapper {
            display: flex;
            align-items: center;
            gap: 20px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .title-wrapper h1 {
            margin: 0;
            padding: 0;
            border-bottom: none;
        }
        .home-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: var(--secondary-color);
            transition: all 0.2s ease-in-out;
            flex-shrink: 0;
            text-decoration: none;
        }
        .home-link:hover {
            transform: scale(1.15);
            color: var(--primary-color);
        }
        .home-link svg {
            width: 32px;
            height: 32px;
        }
        /* Override container width */
        .container {
            max-width: 95%;
        }
        .table-wrapper {
            width: 100%;
            max-height: 65vh; /* Batas tinggi agar bisa scroll */
            overflow: auto; /* Scroll untuk vertikal dan horizontal */
            border: 1px solid #ddd;
            margin-top: 20px;
        }
        table {
            min-width: 2300px; /* Lebar minimum agar semua kolom muat */
        }
        /* Membuat header tabel tetap di atas saat scroll */
        thead th {
            position: sticky;
            top: 0;
            z-index: 10;
        }
        td[contenteditable="true"] {
            background-color: #fef9e7;
            cursor: cell;
        }
        td[contenteditable="true"]:focus {
            background-color: #eaf2f8;
            outline: 2px solid #007bff;
        }
        /* Styling for dropdowns inside table cells */
        td select {
            width: 100%;
            padding: 8px 5px;
            border: 1px solid transparent;
            background-color: transparent;
            font-family: inherit;
            font-size: inherit;
            cursor: pointer;
        }
        td:has(select) {
            background-color: #fef9e7;
            padding: 0;
        }
        td select:focus {
            outline: 2px solid #007bff;
        }

        .controls-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        #searchInput {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            width: 100%;
            max-width: 300px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title-wrapper">
             <a href="bangbin_Rapor.html" class="home-link" title="Kembali ke Menu Utama">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5" />
                </svg>
            </a>
            <h1>Kelola Data Siswa</h1>
        </div>
        <p>Anda bisa mengisi data langsung di tabel di bawah, atau menggunakan fitur Impor dari Excel. Jangan lupa klik "Simpan Perubahan" setelah selesai.</p>

        <div class="controls-wrapper">
             <input type="text" id="searchInput" placeholder="Cari nama siswa...">
            <div class="action-buttons">
                <button id="saveButton">Simpan Semua Perubahan</button>
                <button id="importButton">Impor dari Excel</button>
                <button id="templateButton">Unduh Template Excel</button>
                <input type="file" id="importFile" accept=".xlsx, .xls" style="display: none;">
            </div>
        </div>

        <div class="table-wrapper">
            <table id="tabelSiswa">
                <thead>
                    <tr>
                        <th>No</th>
                        <th>NIS</th>
                        <th>NISN</th>
                        <th>NAMA SISWA</th>
                        <th>L/P</th>
                        <th>Tempat/Tgl Lahir</th>
                        <th>Agama</th>
                        <th>Alamat Jalan</th>
                        <th>Kelurahan</th>
                        <th>Kecamatan</th>
                        <th>Kota</th>
                        <th>Provinsi</th>
                        <th>Nama Ayah</th>
                        <th>Pendidikan Ayah</th>
                        <th>Pekerjaan Ayah</th>
                        <th>Nama Ibu</th>
                        <th>Pendidikan Ibu</th>
                        <th>Pekerjaan Ibu</th>
                        <th>Nama Wali</th>
                        <th>Pendidikan Wali</th>
                        <th>Pekerjaan Wali</th>
                        <th>Pendidikan Sebelumnya</th>
                        <th>Tgl Masuk</th>
                        <th>Gol. Darah</th>
                        <th>Tinggi (cm)</th>
                        <th>Berat (kg)</th>
                    </tr>
                </thead>
                <tbody id="tabelSiswaBody">
                    </tbody>
            </table>
        </div>
    </div>

<script src="bangbin_uhuuy.js"></script>
    <script>
const _0xb5cd68=_0x241d;function _0x241d(_0x26b91f,_0x39dde5){const _0x7d82c=_0x7d82();return _0x241d=function(_0x241d08,_0x1716ae){_0x241d08=_0x241d08-0xaf;let _0x49352b=_0x7d82c[_0x241d08];return _0x49352b;},_0x241d(_0x26b91f,_0x39dde5);}(function(_0x2dcb46,_0x3faa37){const _0x455df3=_0x241d,_0x194bfd=_0x2dcb46();while(!![]){try{const _0x23acf5=-parseInt(_0x455df3(0xbc))/0x1+parseInt(_0x455df3(0xfd))/0x2*(parseInt(_0x455df3(0xc5))/0x3)+-parseInt(_0x455df3(0xbf))/0x4*(parseInt(_0x455df3(0xc4))/0x5)+-parseInt(_0x455df3(0xd7))/0x6+parseInt(_0x455df3(0x107))/0x7*(-parseInt(_0x455df3(0xe5))/0x8)+parseInt(_0x455df3(0xf9))/0x9*(-parseInt(_0x455df3(0xf1))/0xa)+parseInt(_0x455df3(0xda))/0xb;if(_0x23acf5===_0x3faa37)break;else _0x194bfd['push'](_0x194bfd['shift']());}catch(_0x17b92b){_0x194bfd['push'](_0x194bfd['shift']());}}}(_0x7d82,0x25c26),document[_0xb5cd68(0xbd)](_0xb5cd68(0x113),()=>{const _0x501f08=_0xb5cd68,_0x2ef0c2=loadData(),_0x2b9a67=document[_0x501f08(0xc1)]('tabelSiswaBody'),_0x2f0f67=document['getElementById'](_0x501f08(0x105)),_0x53319e=document['getElementById'](_0x501f08(0x104)),_0x2d0006=document['getElementById'](_0x501f08(0xb9)),_0x1697c7=document[_0x501f08(0xc1)]('importFile'),_0x19682c=document[_0x501f08(0xc1)](_0x501f08(0xef)),_0x5e197e=[_0x501f08(0x115),_0x501f08(0x112),_0x501f08(0x109),_0x501f08(0xe8),'ttl',_0x501f08(0x10b),'alamatJalan','kelurahan',_0x501f08(0x101),_0x501f08(0xee),_0x501f08(0xf5),'namaAyah',_0x501f08(0xf7),_0x501f08(0x116),_0x501f08(0xd6),_0x501f08(0x110),'pekerjaanIbu',_0x501f08(0xde),_0x501f08(0xe2),'pekerjaanWali',_0x501f08(0xb0),_0x501f08(0xb1),_0x501f08(0xfc),_0x501f08(0xd8),_0x501f08(0x100)],_0x321459=[_0x501f08(0xb8),_0x501f08(0xdd),_0x501f08(0xfa),_0x501f08(0xdf),_0x501f08(0xc2),'Konghucu'],_0x3c2001=['Laki-laki','Perempuan'],_0x1d146=(_0x388f53,_0x1e6acb,_0x1a1652)=>{const _0x31918a=_0x501f08,_0x482a84=document[_0x31918a(0xbb)]('td'),_0x43bf7c=document[_0x31918a(0xbb)](_0x31918a(0xcb));_0x43bf7c[_0x31918a(0x111)][_0x31918a(0xe1)]=_0x1a1652;const _0x472e0a=document[_0x31918a(0xbb)](_0x31918a(0x103));_0x472e0a[_0x31918a(0xea)]='',_0x472e0a[_0x31918a(0xc6)]=_0x31918a(0x102),_0x472e0a['disabled']=!![];if(!_0x1e6acb)_0x472e0a[_0x31918a(0xb4)]=!![];return _0x43bf7c[_0x31918a(0xc8)](_0x472e0a),_0x388f53[_0x31918a(0xd0)](_0x43ebdd=>{const _0x509f5f=_0x31918a,_0x479477=document[_0x509f5f(0xbb)](_0x509f5f(0x103));_0x479477[_0x509f5f(0xea)]=_0x43ebdd,_0x479477['textContent']=_0x43ebdd,_0x43ebdd===_0x1e6acb&&(_0x479477[_0x509f5f(0xb4)]=!![]),_0x43bf7c[_0x509f5f(0xc8)](_0x479477);}),_0x482a84['appendChild'](_0x43bf7c),_0x482a84;},_0x5207e1=()=>{const _0x2a7c68=_0x501f08;_0x2b9a67[_0x2a7c68(0xc7)]='';const _0x5cb44e=Math[_0x2a7c68(0xcf)](0x20,_0x2ef0c2[_0x2a7c68(0xba)][_0x2a7c68(0x10d)]);for(let _0x181f4d=0x0;_0x181f4d<_0x5cb44e;_0x181f4d++){const _0x148b08=_0x2ef0c2[_0x2a7c68(0xba)][_0x181f4d]||{},_0x1ef2c1=document[_0x2a7c68(0xbb)]('tr');_0x1ef2c1['dataset'][_0x2a7c68(0xce)]=_0x181f4d,_0x1ef2c1[_0x2a7c68(0xc7)]=_0x2a7c68(0xb6)+(_0x181f4d+0x1)+_0x2a7c68(0xe9),_0x5e197e[_0x2a7c68(0xd0)](_0x4cdf3c=>{const _0x216726=_0x2a7c68,_0x188879=_0x148b08[_0x4cdf3c]||'';if(_0x4cdf3c===_0x216726(0xe8))_0x1ef2c1[_0x216726(0xc8)](_0x1d146(_0x3c2001,_0x188879,_0x4cdf3c));else{if(_0x4cdf3c===_0x216726(0x10b))_0x1ef2c1['appendChild'](_0x1d146(_0x321459,_0x188879,_0x4cdf3c));else{const _0x579944=document[_0x216726(0xbb)]('td');_0x579944[_0x216726(0xf0)](_0x216726(0xaf),_0x216726(0xe4)),_0x579944[_0x216726(0x111)][_0x216726(0xe1)]=_0x4cdf3c,_0x579944['textContent']=_0x188879,_0x1ef2c1[_0x216726(0xc8)](_0x579944);}}}),_0x2b9a67['appendChild'](_0x1ef2c1);}},_0x523be9=async()=>{const _0x5a4882=_0x501f08,_0x412635=[],_0x431aac=_0x2b9a67[_0x5a4882(0xc9)]('tr');_0x431aac[_0x5a4882(0xd0)]((_0x27e43e,_0x1673b5)=>{const _0x4fd51b=_0x5a4882,_0x332620={'id':_0x2ef0c2[_0x4fd51b(0xba)][_0x1673b5]?.['id']||'siswa-'+Date[_0x4fd51b(0x10f)]()+Math['random']()};let _0x2498b2=!![];_0x5e197e[_0x4fd51b(0xd0)](_0xbbc372=>{const _0x48bdb4=_0x4fd51b,_0x4e3716=_0x27e43e[_0x48bdb4(0xcd)](_0x48bdb4(0xc3)+_0xbbc372+'\x22]');let _0x6afaae='';if(_0x4e3716){if(_0x4e3716['tagName']===_0x48bdb4(0x10c))_0x6afaae=_0x4e3716[_0x48bdb4(0xea)];else _0x4e3716[_0x48bdb4(0x108)]('contenteditable')&&(_0x6afaae=_0x4e3716[_0x48bdb4(0xc6)][_0x48bdb4(0xd4)]());}_0x332620[_0xbbc372]=_0x6afaae,_0xbbc372===_0x48bdb4(0x109)&&_0x6afaae!==''&&(_0x2498b2=![]);}),!_0x2498b2&&_0x412635['push'](_0x332620);}),_0x2ef0c2[_0x5a4882(0xba)]=_0x412635,saveData(_0x2ef0c2),await showModal('Tersimpan',_0x5a4882(0xfb)),_0x5207e1();},_0x2c4477=()=>{const _0x26d432=_0x501f08,_0x2b84a9={'NIS':'','NISN':'','NAMA\x20SISWA':'','L/P':'Laki-laki\x20/\x20Perempuan','Tempat/Tgl\x20Lahir':_0x26d432(0x10a),'Agama':_0x26d432(0xe3),'Alamat\x20Jalan':'','Kelurahan':'','Kecamatan':'','Kota':'','Provinsi':'','Nama\x20Ayah':'','Pendidikan\x20Ayah':'','Pekerjaan\x20Ayah':'','Nama\x20Ibu':'','Pendidikan\x20Ibu':'','Pekerjaan\x20Ibu':'','Nama\x20Wali':'','Pendidikan\x20Wali':'','Pekerjaan\x20Wali':'','Pendidikan\x20Sebelumnya':'','Tgl\x20Masuk':_0x26d432(0xb5),'Gol.\x20Darah':'','Tinggi\x20(cm)':'','Berat\x20(kg)':''},_0x30bc99=XLSX[_0x26d432(0xb2)][_0x26d432(0xf4)]([_0x2b84a9]),_0x53ed2d=XLSX[_0x26d432(0xb2)][_0x26d432(0xf8)]();XLSX['utils']['book_append_sheet'](_0x53ed2d,_0x30bc99,_0x26d432(0xdc)),XLSX[_0x26d432(0xca)](_0x53ed2d,'Template_Data_Siswa.xlsx');},_0x5c8e91=async _0x25f7e3=>{const _0xe87480=_0x501f08,_0x59270d=_0x25f7e3[_0xe87480(0xec)][_0xe87480(0xbe)][0x0];if(!_0x59270d)return;const _0x3397ad=new FileReader();_0x3397ad[_0xe87480(0x106)]=async _0x2208f7=>{const _0x2605ab=_0xe87480;try{const _0x30d442=new Uint8Array(_0x2208f7[_0x2605ab(0xec)][_0x2605ab(0xd9)]),_0x25660e=XLSX[_0x2605ab(0xd3)](_0x30d442,{'type':'array'}),_0xdc6f68=_0x25660e['SheetNames'][0x0],_0x2fe80d=_0x25660e['Sheets'][_0xdc6f68],_0x2dbef2=XLSX[_0x2605ab(0xb2)][_0x2605ab(0xb7)](_0x2fe80d);if(_0x2dbef2[_0x2605ab(0x10d)]===0x0){await showModal(_0x2605ab(0xe6),_0x2605ab(0x118));return;}const _0xd92bab=await showModal('Konfirmasi\x20Impor','Ditemukan\x20'+_0x2dbef2[_0x2605ab(0x10d)]+_0x2605ab(0xf2),!![]);if(!_0xd92bab)return;const _0x548298=_0x2dbef2[_0x2605ab(0xd1)](_0x4c6779=>{const _0x213431=_0x2605ab,_0x4947d1={'id':_0x213431(0xff)+Date[_0x213431(0x10f)]()+Math[_0x213431(0xe7)]()},_0x4b94ef={'NIS':_0x213431(0x115),'NISN':'nisn','NAMA\x20SISWA':_0x213431(0x109),'L/P':_0x213431(0xe8),'Tempat/Tgl\x20Lahir':_0x213431(0xcc),'Agama':_0x213431(0x10b),'Alamat\x20Jalan':'alamatJalan','Kelurahan':_0x213431(0xfe),'Kecamatan':_0x213431(0x101),'Kota':_0x213431(0xee),'Provinsi':'provinsi','Nama\x20Ayah':_0x213431(0xeb),'Pendidikan\x20Ayah':_0x213431(0xf7),'Pekerjaan\x20Ayah':_0x213431(0x116),'Nama\x20Ibu':_0x213431(0xd6),'Pendidikan\x20Ibu':_0x213431(0x110),'Pekerjaan\x20Ibu':'pekerjaanIbu','Nama\x20Wali':_0x213431(0xde),'Pendidikan\x20Wali':'pendidikanWali','Pekerjaan\x20Wali':_0x213431(0x114),'Pendidikan\x20Sebelumnya':_0x213431(0xb0),'Tgl\x20Masuk':_0x213431(0xb1),'Gol.\x20Darah':'golonganDarah','Tinggi\x20(cm)':'tinggiBadan','Berat\x20(kg)':_0x213431(0x100)};for(const _0x10cb28 in _0x4b94ef){_0x4947d1[_0x4b94ef[_0x10cb28]]=_0x4c6779[_0x10cb28]||'';}return _0x4947d1;});_0x2ef0c2['dataSiswa']=_0x548298,saveData(_0x2ef0c2),await showModal(_0x2605ab(0xf6),'Data\x20berhasil\x20diimpor!'),_0x5207e1();}catch(_0x1f6b51){console[_0x2605ab(0x119)](_0x2605ab(0x10e),_0x1f6b51),await showModal('Error',_0x2605ab(0xd5));}finally{_0x1697c7['value']='';}},_0x3397ad['readAsArrayBuffer'](_0x59270d);},_0x26c600=()=>{const _0x2004cc=_0x501f08,_0x4050f7=_0x19682c[_0x2004cc(0xea)][_0x2004cc(0xe0)](),_0x56e083=_0x2b9a67[_0x2004cc(0xc9)]('tr');_0x56e083[_0x2004cc(0xd0)](_0x5da4ba=>{const _0x36621f=_0x2004cc,_0x551cb1=_0x5da4ba['querySelector'](_0x36621f(0xdb));if(_0x551cb1){const _0x50abe2=_0x551cb1[_0x36621f(0xc6)][_0x36621f(0xe0)]()[_0x36621f(0xc0)](_0x4050f7);_0x5da4ba[_0x36621f(0xf3)][_0x36621f(0xb3)]=_0x50abe2?'':_0x36621f(0xed);}});};_0x2f0f67[_0x501f08(0xbd)](_0x501f08(0xd2),_0x523be9),_0x2d0006[_0x501f08(0xbd)](_0x501f08(0xd2),_0x2c4477),_0x53319e[_0x501f08(0xbd)]('click',()=>_0x1697c7['click']()),_0x1697c7[_0x501f08(0xbd)]('change',_0x5c8e91),_0x19682c[_0x501f08(0xbd)](_0x501f08(0x117),_0x26c600),_0x5207e1();}));function _0x7d82(){const _0x123216=['style','json_to_sheet','provinsi','Berhasil','pendidikanAyah','book_new','387cFPGnE','Katholik','Semua\x20perubahan\x20data\x20siswa\x20berhasil\x20disimpan!','golonganDarah','209300kzeKqV','kelurahan','siswa-','beratBadan','kecamatan','--\x20Pilih\x20--','option','importButton','saveButton','onload','763aaZAwZ','hasAttribute','nama','Contoh:\x20Jakarta,\x2017-08-2015','agama','SELECT','length','Error\x20importing\x20file:','now','pendidikanIbu','dataset','nisn','DOMContentLoaded','pekerjaanWali','nis','pekerjaanAyah','keyup','File\x20Excel\x20kosong\x20atau\x20format\x20tidak\x20sesuai.','error','contenteditable','pendidikanSebelumnya','tanggalMasuk','utils','display','selected','DD-MM-YYYY','<td>','sheet_to_json','Islam','templateButton','dataSiswa','createElement','67339KZQJKY','addEventListener','files','40bpFmKw','includes','getElementById','Budha','[data-field=\x22','14920YaLKDR','3PGdGNc','textContent','innerHTML','appendChild','querySelectorAll','writeFile','select','ttl','querySelector','index','max','forEach','map','click','read','trim','Terjadi\x20kesalahan\x20saat\x20mengimpor\x20file.\x20Pastikan\x20format\x20file\x20benar.','namaIbu','723654MOLDzJ','tinggiBadan','result','5577374Rtwmpt','[data-field=\x22nama\x22]','DataSiswa','Protestan','namaWali','Hindu','toLowerCase','field','pendidikanWali','Pilih\x20dari:\x20Islam,\x20Protestan,\x20dll.','true','12632fVXLVH','Error','random','kelamin','</td>','value','namaAyah','target','none','kota','searchInput','setAttribute','15610qTOleA','\x20data\x20siswa.\x20Impor\x20data\x20ini\x20akan\x20menimpa\x20data\x20yang\x20ada.\x20Lanjutkan?'];_0x7d82=function(){return _0x123216;};return _0x7d82();}
    </script>
</body>
</html>